---
title: "线性代数上机课"
author: "吕舒君"
date: "2025-12-16"
footer-center: "大连理工大学 20252111170"
output: pdf_document
CJKmainfont: Noto Serif CJK SC
CJKsansfont: Noto Sans CJK SC
CJKmonofont: Noto Sans Mono CJK SC
mainfont: Libertinus Serif
sansfont: Libertinus Sans
---

姓名：吕舒君

班级：软国际2508

学号：20252111170

任课老师：代万基老师

# 线性代数上机课-第一次作业

## 上机作业（一）

随机生成5阶方阵$\mathbf{A}, \mathbf{B}, \mathbf{C}$及5维列向量$\mathbf{b}$ 

1. $\mathbf{A+B}, \mathbf{A-B}$
2. $\mathbf{A*B+B*A}$
3. $\mathbf{A,B}$的行列式，逆，秩
4. $\mathbf{A*B}$的行列式，逆，秩，并验证$\det(\mathbf{A*B})=\det(\mathbf{A})*\det(\mathbf{B})$
5. 验证$(\mathbf{AB})^T = \mathbf{B}^T\mathbf{A}^T, (\mathbf{AB})^{-1} = \mathbf{B}^{-1}\mathbf{A}^{-1}, \mathbf{AB} \neq \mathbf{BA}$
6. 求矩阵$\mathbf{X}$使得$\mathbf{AXB=C}$

### 代码
```matlab
A=rand(4,4)
B=rand(4,4)
C=rand(4,4)
b=rand(4,1)

disp("1.A+B,A-B")
A+B
A-B

disp("2.A*B+B*A")
A*B+B*A

disp("3.A,B的行列式，逆，秩")
det(A)
inv(A)
rank(A)
det(B)
inv(B)
rank(B)

disp("4.A*B的行列式，逆，秩，并验证det(A*B)=det(A)*det(B)")
det(A*B)
inv(A*B)
rank(A*B)
det(A)*det(B)

disp("5.验证(AB)^T=B^TA^T,(AB)^-1=B^-1A^-1,AB!=BA")
disp("（1）")
(A*B)'
B'*A'
disp("（2）")
inv(A*B)
inv(B)*inv(A)
disp("（3）")
A*B
B*A


disp("6.求矩阵X使得AXB=C")
X=(A\C)/B
```
### 结果
```
A =

    0.8604    0.7856    0.1339    0.2955
    0.9344    0.5134    0.0309    0.3329
    0.9844    0.1776    0.9391    0.4671
    0.8589    0.3986    0.3013    0.6482


B =

    0.0252    0.3479    0.6628    0.9884
    0.8422    0.4460    0.3308    0.5400
    0.5590    0.0542    0.8985    0.7069
    0.8541    0.1771    0.1182    0.9995


C =

    0.2878    0.8182    0.0567    0.2089
    0.4145    0.1002    0.5219    0.9052
    0.4648    0.1781    0.3358    0.6754
    0.7640    0.3596    0.1757    0.4685


b =

    0.9121
    0.1040
    0.7455
    0.7363

1.A+B,A-B

ans =

    0.8857    1.1334    0.7967    1.2840
    1.7766    0.9594    0.3617    0.8729
    1.5434    0.2318    1.8376    1.1740
    1.7130    0.5757    0.4195    1.6477


ans =

    0.8352    0.4377   -0.5289   -0.6929
    0.0922    0.0674   -0.2999   -0.2070
    0.4254    0.1234    0.0407   -0.2398
    0.0048    0.2215    0.1832   -0.3513

2.A*B+B*A

ans =

    2.8588    1.4194    1.9199    2.7383
    2.6885    1.7793    1.4562    2.4573
    3.1217    1.4637    2.7436    3.2608
    2.9546    1.7890    1.5805    2.9395

3.A,B的行列式，逆，秩

ans =

   -0.0931


ans =

   -1.4565    3.0316    0.5132   -1.2629
    2.7936   -2.3646   -0.3923    0.2236
    1.1613   -1.8935    1.0657   -0.3248
   -0.3276   -1.6831   -0.9341    3.2297


ans =

     4


ans =

   -0.3111


ans =

   -0.9780    0.5767    0.4663    0.3258
    1.0354    2.0660   -1.3706   -1.1707
    0.0362    0.2119    1.1334   -0.9519
    0.6480   -0.8840   -0.2896    1.0421


ans =

     4

4.A*B的行列式，逆，秩，并验证det(A*B)=det(A)*det(B)

ans =

    0.0290


ans =

    3.4704   -5.7601   -0.5356    2.2649
    3.0553    2.8193   -0.6463   -4.1816
    2.1676   -0.9355    2.0325   -3.4408
   -4.0910    2.8493   -0.6026    2.4436


ans =

     4


ans =

    0.0290

5.验证(AB)^T=B^TA^T,(AB)^-1=B^-1A^-1,AB!=BA
（1）

ans =

    1.0106    0.7576    1.0983    1.0794
    0.7093    0.6147    0.5553    0.6077
    0.9854    0.8563    1.6102    1.0485
    1.6647    1.5554    2.1996    1.9251


ans =

    1.0106    0.7576    1.0983    1.0794
    0.7093    0.6147    0.5553    0.6077
    0.9854    0.8563    1.6102    1.0485
    1.6647    1.5554    2.1996    1.9251

（2）

ans =

    3.4704   -5.7601   -0.5356    2.2649
    3.0553    2.8193   -0.6463   -4.1816
    2.1676   -0.9355    2.0325   -3.4408
   -4.0910    2.8493   -0.6026    2.4436


ans =

    3.4704   -5.7601   -0.5356    2.2649
    3.0553    2.8193   -0.6463   -4.1816
    2.1676   -0.9355    2.0325   -3.4408
   -4.0910    2.8493   -0.6026    2.4436

（3）

ans =

    1.0106    0.7093    0.9854    1.6647
    0.7576    0.6147    0.8563    1.5554
    1.0983    0.5553    1.6102    2.1996
    1.0794    0.6077    1.0485    1.9251


ans =

    1.8482    0.7101    0.9344    1.0735
    1.9309    1.1646    0.6000    0.9019
    2.0234    0.9083    1.1334    1.0611
    1.8752    1.1812    0.5320    1.0144

6.求矩阵X使得AXB=C

X =

    0.0710   -4.1524    2.7740    2.4071
    1.1609    5.4163   -3.7367   -3.1491
    0.4538    2.2717   -1.6798   -1.3921
   -1.1189    2.3605   -0.7102   -0.3766
```

## 上机作业（二）
验证：对于一般的方阵$\mathbf{A,B,C,D}$
$$
\begin{vmatrix} A & B \\ C & D \end{vmatrix} \neq |A||D| - |B||C|
$$
若$\mathbf{A,C}$均为对角矩阵，且$\mathbf{A}$可逆，则
$$
\begin{vmatrix} A & B \\ C & D \end{vmatrix} = |AD - CB|
$$

### 代码
```matlab
A=rand(4,4)
B=rand(4,4)
C=rand(4,4)
D=rand(4,4)

disp("（1）")
det([A,B;C,D])
det(A)*det(D)-det(B)*det(C)

a1=rand(1,4)
%去除0，确保可逆
a1(a1 == 0) = 0.1;
A=diag(a1)
c1=rand(1,4)
C=diag(c1)

disp("（2）")
det([A,B;C,D])
det(A*D-C*B)
```

### 结果
```
A =

    0.6225    0.4709    0.2259    0.3111
    0.5870    0.2305    0.1707    0.9234
    0.2077    0.8443    0.2277    0.4302
    0.3012    0.1948    0.4357    0.1848


B =

    0.9049    0.2581    0.6028    0.2967
    0.9797    0.4087    0.7112    0.3188
    0.4389    0.5949    0.2217    0.4242
    0.1111    0.2622    0.1174    0.5079


C =

    0.0855    0.9289    0.2373    0.5211
    0.2625    0.7303    0.4588    0.2316
    0.8010    0.4886    0.9631    0.4889
    0.0292    0.5785    0.5468    0.6241


D =

    0.6791    0.0377    0.0987    0.1366
    0.3955    0.8852    0.2619    0.7212
    0.3674    0.9133    0.3354    0.1068
    0.9880    0.7962    0.6797    0.6538

（1）

ans =

    0.0100


ans =

    0.0146


a1 =

    0.4942    0.7791    0.7150    0.9037


A =

    0.4942         0         0         0
         0    0.7791         0         0
         0         0    0.7150         0
         0         0         0    0.9037


c1 =

    0.8909    0.3342    0.6987    0.1978


C =

    0.8909         0         0         0
         0    0.3342         0         0
         0         0    0.6987         0
         0         0         0    0.1978

（2）

ans =

    0.0371


ans =

    0.0371
```

## 上机作业（三）
生成4阶随机矩阵$\mathbf{A}$，完成下面操作：

- 取出$\mathbf{A}$的前3行构成矩阵$\mathbf{B}$；
- 取出$\mathbf{A}$的前2列构成矩阵$\mathbf{C}$；
- 右下角$3{\times}2$矩阵构成矩阵$\mathbf{D}$；
- $\mathbf{B}$与$\mathbf{C}$的乘积构成矩阵$\mathbf{E}$。

### 代码
```matlab
A=rand(4,4)
B=A(1:3,:)
C=A(:,1:2)
D=A(2:4,3:4)
E=B*C
```

### 结果
```
A =

    0.0305    0.9047    0.8055    0.8865
    0.7441    0.6099    0.5767    0.0287
    0.5000    0.6177    0.1829    0.4899
    0.4799    0.8594    0.2399    0.1679


B =

    0.0305    0.9047    0.8055    0.8865
    0.7441    0.6099    0.5767    0.0287
    0.5000    0.6177    0.1829    0.4899


C =

    0.0305    0.9047
    0.7441    0.6099
    0.5000    0.6177
    0.4799    0.8594


D =

    0.5767    0.0287
    0.1829    0.4899
    0.2399    0.1679


E =

    1.5023    1.8388
    0.7786    1.4260
    0.8014    1.3631
```
## 上机作业（四）
在房地产市场中，房价受到多种因素的影响，例如房屋面积、卧室和卫生间数量、楼层、建造时间、距市中心的距离，以及学区、交通、环境等评分指标（评分指标1-10）。这些因素之间可能存在较强的相关性（例如卧室数与卫生间数往往接近），在用线性代数方法建立回归模型时，可能会引起模型结果的不稳定。

为此，我们可以构造一个特征矩阵$\mathbf{A}$
- 每一列对应一个影响房价的因素（面积、卧室数、卫生间数…）
- 每一行记录一套房子的各项数据。

同时，构造一个目标向量$\vec{b}$，每一行代表该套房屋的房价。通过解方程$\mathbf{A}\vec{x}=\vec{b}$，得到系数向量$\vec{x}$，其中的每个元素表示相应因素对房价的“贡献权重”。例如，面积的权重可能最大，说明面积对房价的影响最显著；而环境评分的权重可能相对较小。

1. 构造一个不少于8套房屋的数据表。每行记录一套房屋的各类指标，最后一列为房价（万元）。导入Data数据后拆分特征矩阵$A$，目标向量$b$为房价。向量$b$是Data中最后一列，其余数据构造矩阵$A$。
2. 采用MATLAB内置的直接法$Ax=b$求解$x$
3. 采用正规方程 $\left(A^TA\right)x = A^Tb$ 求解$x$
4. 比较回答两种方法是否一致？如果某两项数据高度相关（如“卫生间数量≈卧室数量”），矩阵$A$的秩会如何变化？结果是否稳定？

### 代码
```matlab
data=readmatrix('fj.xlsx')
A=data(:,1:6)
b=data(:,7)
x1=A\b
x2=(A'*A)\(A'*b)
```
### 结果
```
data =

         120           3           2           5           8         500         320
          89           2           1          12          15         300         280
         150           4           3           3           5         800         450
          75           2           1           8          20         250         220
         180           4           3           2           3        1000         580
          95           3           2          15          12         400         310
         135           3           2           6          10         600         380
         110           3           2           4           7         350         340
         165           4           3          10          18         700         420
         140           3           2           7           6         450         360

>> hw4

data =

         120           3           2           5           8         500         320
          89           2           1          12          15         300         280
         150           4           3           3           5         800         450
          75           2           1           8          20         250         220
         180           4           3           2           3        1000         580
          95           3           2          15          12         400         310
         135           3           2           6          10         600         380
         110           3           2           4           7         350         340
         165           4           3          10          18         700         420
         140           3           2           7           6         450         360


A =

         120           3           2           5           8         500
          89           2           1          12          15         300
         150           4           3           3           5         800
          75           2           1           8          20         250
         180           4           3           2           3        1000
          95           3           2          15          12         400
         135           3           2           6          10         600
         110           3           2           4           7         350
         165           4           3          10          18         700
         140           3           2           7           6         450


b =

   320
   280
   450
   220
   580
   310
   380
   340
   420
   360


x1 =

    0.8859
  146.0923
 -155.7167
    1.5868
   -3.3886
    0.2849


x2 =

    0.8859
  146.0923
 -155.7167
    1.5868
   -3.3886
    0.2849
```

# 线性代数上机课-第二次作业

## 上机作业（一）

化简二次型$f\left(x_1,x_2,x_3\right)=x_1^2+3x_1x_2-x_2^2+2x_2x_3+x_3^2$并判断正定性。

### 代码

```matlab
A = [1, 1.5, 0; 
     1.5, -1, 1; 
     0, 1, 1];
eigA = eig(A);
disp('Eig：');
disp(eigA);
if all(eigA > 0)
    disp('正定');
elseif all(eigA >= 0)
    disp('半正定');
elseif all(eigA < 0)
    disp('负定');
elseif all(eigA <= 0)
    disp('半负定');
else
    disp('不定');
end
```

### 结果

```
Eig：
  -2.06155
   1.00000
   2.06155
不定
```

## 上机作业（二）

生成10阶随机矩阵，要求其各列和为1，用两种方法完成以下任务

- 计算其特征值，观察其最大特征值的值
- 计算最大特征值对应的特征向量

### 代码

方法一：
```matlab
clear; clc;
n = 10;
A = rand(n);
A1 = A ./ sum(A, 1);
disp('方法1生成的矩阵：');
disp(A1);

eigvals1 = eig(A1);
[V1, D1] = eig(A1);
eig_abs1 = abs(eigvals1);
[max_eigval1, idx1] = max(eig_abs1);
max_vec1 = V1(:, idx1);

fprintf('最大特征值: %.6f\n', max_eigval1);
fprintf('最大特征值对应特征向量: \n');
disp(max_vec1');
```

方法二：
```matlab
A2 = rand(n)';
A2 = A2 ./ sum(A2, 2);
A2 = A2';
disp('方法2生成的矩阵：');
disp(A2);

eigvals2 = eig(A2);
[V2, D2] = eig(A2);
eig_abs2 = abs(eigvals2);
[max_eigval2, idx2] = max(eig_abs2);
max_vec2 = V2(:, idx2);

fprintf('最大特征值: %.6f\n', max_eigval2);
fprintf('最大特征值对应特征向量: \n');
disp(max_vec2');
```

### 结果

代码一：
```
方法1生成的矩阵：
 Columns 1 through 6:

   0.1091499   0.0632799   0.0114853   0.0862569   0.1496693   0.1451295
   0.1751305   0.0783785   0.1199930   0.0917693   0.0322333   0.1309236
   0.0035188   0.0214086   0.1054067   0.0030591   0.1866502   0.1059306
   0.1392205   0.1109179   0.1078849   0.1104404   0.0489111   0.1403925
   0.0731157   0.1336490   0.1554915   0.0777238   0.1569878   0.1066272
   0.1500932   0.1562009   0.1501692   0.1608871   0.0017893   0.0139886
   0.0061660   0.1163630   0.1139702   0.1346498   0.1697739   0.0169486
   0.1121050   0.1508608   0.0658607   0.0574640   0.0344674   0.0656866
   0.1416640   0.1011695   0.1236023   0.1621346   0.0111558   0.1458167
   0.0898363   0.0677719   0.0461362   0.1156151   0.2083618   0.1285560

 Columns 7 through 10:

   0.1424179   0.1227443   0.1392873   0.1051187
   0.0424677   0.0393527   0.0753962   0.1467459
   0.0677480   0.1154781   0.0983438   0.0828724
   0.1196048   0.1832740   0.1132729   0.0010245
   0.1974264   0.0703766   0.0127621   0.1011749
   0.0428949   0.0942460   0.0397916   0.0093687
   0.1191089   0.0245821   0.1991214   0.1306363
   0.0355854   0.1715005   0.0717926   0.1675892
   0.0738734   0.0701926   0.1206564   0.1719560
   0.1588726   0.1082531   0.1295758   0.0835134
最大特征值: 1.000000
最大特征值对应特征向量: 
 Columns 1 through 8:

   0.34451   0.29182   0.24453   0.32862   0.33481   0.25043   0.33381   0.29401

 Columns 9 and 10:

   0.35226   0.36276
```

代码二：
```
方法2生成的矩阵：
 Columns 1 through 6:

   0.1649735   0.1706803   0.0562896   0.0549730   0.0481135   0.0168820
   0.0931988   0.0768446   0.1373486   0.1679000   0.0175822   0.1281790
   0.1317361   0.0683450   0.0055587   0.1390104   0.2893810   0.0911787
   0.0210105   0.0234719   0.0574515   0.1540627   0.0717128   0.1669789
   0.1313560   0.1474570   0.1609090   0.0922171   0.0483355   0.0571653
   0.1002543   0.1235106   0.0425004   0.0113800   0.1116776   0.0103142
   0.1375457   0.1284894   0.1927978   0.0796271   0.1416648   0.1647411
   0.1221745   0.0794183   0.0022460   0.1911591   0.0250130   0.1559001
   0.0527316   0.0151241   0.1533725   0.0026084   0.1539272   0.1322433
   0.0450190   0.1666588   0.1915260   0.1070621   0.0925923   0.0764174

 Columns 7 through 10:

   0.0326346   0.0527250   0.0677871   0.1345471
   0.1131569   0.1632117   0.1209440   0.0898885
   0.0543030   0.0010817   0.0026719   0.0308388
   0.0935222   0.0348217   0.2351185   0.0737513
   0.0298865   0.0019879   0.2087484   0.0838384
   0.1890886   0.0678735   0.1046171   0.1540423
   0.0024269   0.1983074   0.0131076   0.0665527
   0.1217058   0.1820432   0.0903432   0.0935164
   0.1693120   0.1992986   0.0588753   0.1333313
   0.1939636   0.0986493   0.0977869   0.1396932
最大特征值: 1.000000
最大特征值对应特征向量: 
 Columns 1 through 8:

   0.25370   0.34611   0.24399   0.29559   0.29586   0.29969   0.33926   0.33910

 Columns 9 and 10:

   0.33806   0.38369
```

## 上机作业（三）

随机生成4个5维向量，并进行正交化。

### 代码
```matlab
A = randn(5,4);
[Q, R] = qr(A, 0);
disp('正交化后的4个5维向量：');
disp(Q);
disp('Q^T * Q =');
disp(Q' * Q);
```

### 结果
```
正交化后的4个5维向量：
  -0.713090  -0.144080   0.479910  -0.423260
   0.338638  -0.404846   0.068420   0.133796
   0.385971  -0.144133  -0.213949  -0.883147
   0.300206  -0.558793   0.611802   0.109221
   0.371120   0.694490   0.587307  -0.105222
Q^T * Q =
   1.00000   0.00000   0.00000   0.00000
   0.00000   1.00000  -0.00000   0.00000
   0.00000  -0.00000   1.00000   0.00000
   0.00000   0.00000   0.00000   1.00000
```
## 上机作业（四）
某城市共30万人从事农业、工业、商业工作，假定此人数不变，另外，社会调查表明：

1. 在此30万人中，目前约15万人从事农业，9万人从事工业，6万人从事商业；
2. 农业人员中，每年20%转为工业，10%转为商业；
3. 工业人员中，每年20%转为农业，10%转为商业；
4. 商业人员中，每年10%转为农业，10%转为工业；

预测一、二年后各行业人数，及若干年后各行业人数。

### 代码
```matlab
x0 = [15; 9; 6];
P = [0.7 0.2 0.1;
     0.2 0.7 0.1;
     0.1 0.1 0.8];
x1 = P * x0;
x2 = P^2 * x0;
disp('一年后各行业人数（万人）：')
disp(x1)
disp('两年后各行业人数（万人）：')
disp(x2)
x = x0;
for k = 1:50
    x = P * x;
end
disp('若干年后稳定人数（万人）：')
disp(x)
```

### 结果
```
一年后各行业人数（万人）：
   12.9000
    9.9000
    7.2000
两年后各行业人数（万人）：
   11.7300
   10.2300
    8.0400
若干年后稳定人数（万人）：
   10.0000
   10.0000
   10.0000
```

## 上机作业（五）
查询eigs命令的作用，并给出一个例子

### 代码
```matlab
n = 1000;
A = spdiags([-ones(n,1) 2*ones(n,1) -ones(n,1)], -1:1, n, n);
[V, D] = eigs(A, 3, 'SM');
disp('最小的3个特征值：');
disp(diag(D));
```

### 结果
```matlab
最小的3个特征值：
   8.8648e-05
   3.9399e-05
   9.8499e-06
```

## 上机作业（六）
随机生成5阶方阵$\mathbf{A}$，$\mathbf{B}$，$\mathbf{C}$及5维列向量$\vec{b}$求$\mathbf{A}x=\vec{b}$的解，并验证克莱姆法则。

### 代码
```matlab
clear; clc;
format long;
n = 5;
A = randn(n);
B = randn(n);
C = randn(n);
b = randn(n, 1);
disp('=== 生成的矩阵和向量 ===');
disp('矩阵 A:');
disp(A);
disp('矩阵 B:');
disp(B);
disp('矩阵 C:');
disp(C);
disp('向量 b:');
disp(b);
disp(' ');
x_solution = A \ b;
x_inv = inv(A) * b;
disp('=== 解 Ax = b ===');
disp(x_solution);
if det(A) ~= 0
    fprintf('det(A) = %.6f\n', det(A));
    x_cramer = zeros(n, 1);
    for j = 1:n
        Aj = A;
        Aj(:, j) = b;
        det_Aj = det(Aj);
        x_cramer(j) = det_Aj / det(A);
    end
    disp('=== 克莱姆法则计算结果 ===');
    disp('使用克莱姆法则得到的解 x:');
    disp(x_cramer);
    disp('=== 比较结果 ===');
    fprintf('克莱姆法则解与A\\b解的差异范数: %.2e\n', norm(x_cramer - x_solution));
    fprintf('相对误差: %.2e\n\n', norm(x_cramer - x_solution) / norm(x_solution)); 
else
    fprintf('A不可逆，det(A) = %.6e，不能使用克莱姆法则\n', det(A));
end
```

### 结果
```
=== 生成的矩阵和向量 ===
矩阵 A:
 Columns 1 through 3:

   1.6332367890919561   0.4069824691178683  -1.2288503243831479
   0.3891498643434080   0.3714993436053099   0.3431928678575496
  -1.3992208527819243  -1.2748023241173327  -0.5755243963641870
  -1.6064035868046966   1.6112590733994692  -0.3974534247577898
   1.4710041962189595   0.8196860102555682   0.4193978040759000

 Columns 4 and 5:

   0.5060529601511976  -0.2247550596855101
  -1.1269306444252587   0.2096791331051665
  -0.4156742886496996   1.1219385826826287
  -1.8670011790436929   0.8917308218162947
   1.2767328330459229  -0.0832444593136521
矩阵 B:
 Columns 1 through 3:

   0.0574587027349662   1.1055376743213905   2.6669694040106569
  -1.1704327747820684  -0.1397080897714048   0.2912088910828480
   0.0982088877327710  -1.3668971719796217   1.9976644673785633
  -1.8744533740852045   1.0662072212585536   1.0198982968307202
  -0.3559602300837525   2.0586191026925165   2.3790826807871825

 Columns 4 and 5:

  -1.1145890636519480  -0.5282806849113717
  -3.1610850269766391  -1.9414460524806880
   0.7516932145071132  -0.2867087184424251
  -0.5792242648437395   1.4873924200118005
   0.7739667903588482  -1.0045064133690151
矩阵 C:
 Columns 1 through 3:

   0.5753076716410552  -0.4334124662058851   0.8595105115331719
   0.6759842763794462   0.3881292388379326   0.2225170297202552
   1.1580903049007216   1.2316258576997265   2.2961813399328657
   0.7861420537044533  -0.9241308262814475   0.0711031758564847
  -0.0707095034287853  -2.2386756505333234   0.1080614712073433

 Columns 4 and 5:

  -0.2454895730755914  -0.1836703358072583
   0.9498552027161355   1.4549870304154984
  -0.8280071053007393  -1.5550780094028709
  -0.6149644038689488   0.5306707823266531
  -0.2266714501993035   0.9678022000890008
向量 b:
   0.142044505098286
  -0.521246793552802
   2.102832704632213
   0.890369057159877
  -0.201461045363428
 
=== 解 Ax = b ===
  -0.2493644634661184
  -0.0730412616907036
  -0.5390744298766879
   0.4426708288357551
   1.3677753817956466
det(A) = -12.612583
=== 克莱姆法则计算结果 ===
使用克莱姆法则得到的解 x:
  -0.2493644634661183
  -0.0730412616907037
  -0.5390744298766880
   0.4426708288357551
   1.3677753817956466
=== 比较结果 ===
克莱姆法则解与A\b解的差异范数: 2.03e-16
相对误差: 1.30e-16
```

## 上机作业（七）

首先由题意得到：
$$
A=\begin{bmatrix}
83&86&50&88&3&4\\
1&2&3&4&4&3\\
12&15&22&17&5&7\\
28&63&83&60&8&0
\end{bmatrix}
$$
求A列向量组的一个最大无关组，并把不属于极大无关组的向量利用极大无关组表示.

### 代码
```matlab
A = [83 86 50 88 3 4;
     1  2  3  4  4 3;
     12 15 22 17 5 7;
     28 63 83 60 8 0];
[R, pivot] = rref(A);
disp('行最简形 R =');
disp(R)
disp('主列（极大无关组所在列号） =');
disp(pivot)
B = A(:, pivot);
disp('极大无关组向量：')
disp(B)
all_cols = 1:size(A,2);
free_cols = setdiff(all_cols, pivot);
disp('非极大无关组列号 =');
disp(free_cols)
for k = free_cols
    c = B \ A(:,k);
    fprintf('第 %d 列的线性表示系数为：\n', k);
    disp(c)
end
```

### 结果
```
行最简形 R =
   1.00000   0.00000   0.00000   0.00000  -0.35479   0.46563
   0.00000   1.00000   0.00000   0.00000  -1.49050  -2.00197
   0.00000   0.00000   1.00000   0.00000   0.04733   0.39504
   0.00000   0.00000   0.00000   1.00000   1.79845   1.33829
主列（极大无关组所在列号） =
   1   2   3   4
极大无关组向量：
   83   86   50   88
    1    2    3    4
   12   15   22   17
   28   63   83   60
非极大无关组列号 =
   5   6
第 5 列的线性表示系数为：
  -0.354785
  -1.490495
   0.047330
   1.798446
第 6 列的线性表示系数为：
   0.46563
  -2.00197
   0.39504
   1.33829
```